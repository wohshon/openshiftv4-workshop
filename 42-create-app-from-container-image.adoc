[[create-an-app-from-a-container-image]]
= Create an App from a Container image

== Create an App from a Container image

In this lab you will learn how to create a new project on OpenShift and
how to create an application from an existing docker image using Web UI.

=== Add a new project

IMPORTANT: Please replace *Username* with your username

- login to web UI via {{CONSOLE_ADDRESS}} (You may want to do a `right-click` to open the web console in a new tab or window and keep this page open)
- Use the same username and password that assigned to you

=== Switching to Developer View

- On the left-hand side menu, select the `Administrator` dropdown menu and switch to `Developer`.

image::ocp4-role-dropdown.png[image]

- This will bring you to the `Developer` View.

image::ocp4-dev-home.png[image]

- We will now create a `Project`, a `Project` is like a workspace for you to group your resources.
- On the left-hand side menu, under `Advance`, select `Project`
- Click `Create Project`

image::ocp4-dev-home-project.png[image]

- Enter *web-terminal-<Username>* as name of the project, e.g. web-terminal-user02. The display name and description is optional.

image::ocp4-dev-create-project.png[image]

- You will be led to the `Project Overview' page.`

image::ocp4-dev-create-project.png[image]


=== Deploy an Image

- There are various ways to deploy a workload on OpenShift Container Platform: Via source codes, binaries or directly deploying an image. We will look at deploying an image directly.

- Click on the `+Add`, item on the left-hand side menu, you will be presented with the different options to deploy your image
- Choose the `Container Image` option. (Typically the 2nd item from the left)

image::ocp4-dev-add.png[image]

- You will be led ot the `Deploy Image` page

image::ocp4-dev-deploy-image1.png[image]


- Enter `quay.io/openshiftlabs/workshop-terminal:2.4.0` in the `Image Name` box,
  noting that there's no `http://`, enter exactly as shown here,
  without the quotes
- Select the magnifying glass icon to the right of the box
- Use the default `Name` for the deployment

image::ocp4-dev-deploy-image2.png[image]

- Scroll further down, under the `Advanced Options`, you will see 
  - Checkbox for `Create a route to the application`, leave this box checked, a route provides an ingress point for external traffic to access the container services.
  - You will also see a line of text that lets you access further advanced options

image::ocp4-dev-deploy-image-3.png[image]

- Click on the `Deployment Configuration` hyperlink on the line of text.
- Add `OC_VERSION` and `4.2` in the  `Environment Variable` section

image::ocp4-dev-deploy-image3.png[image]

- Click `Create` to start deploying your image.

- You will be led to the topology page where you can see the deployment details.
- Click on the icon to pull out a side panel for more information.

image::ocp4-dev-deploy-image-topology.png[image]

- Once the icon shows a dark blue circle, the deployment is completed

image::ocp4-dev-deploy-image-route.png[image]


image::ocp4-dc.png[image]

- click the tab `Pods` to watch the deployment to complete

image::ocp4-terminal.png[image]

- Navigate to `Home` --> `Events` to check status on each events.

Events in OpenShift Container Platform are modeled based on events that happen
to API objects in an OpenShift Container Platform cluster. Events allow OpenShift
Container Platform to record information about real-world events in a resource-
agnostic manner. For more information, please see
https://docs.openshift.com/container-platform/3.11/security/monitoring.html#security-monitoring-events.

== Create route

Next we need to create a route so we can access this application from the outside of OpenShift (i.e. from the internet).

- Navigate to `Networking` --> `Routes`
- Click `Create Route` in the top-left
- Enter `workshop-terminal` for the name of the route, leave the hostname and path the default
- Select `workshop-terminal` from the list of services in the `Service` menu
- Select the only port in the `Target Port` drop down (should be port 10080 --> 10080), like this:

image::ocp4-route.png[image]

- Click `Create` at the bottom and it will create the route.
- You will now be presented with a pane that shows the overview of the route:

image::ocp4-route-details.png[image]


=== Accessing the terminal

- In the top right hand side of the route details page, you will see the `LOCATION`
which will be the routable URL that will provide access to our workshop terminal.
- Click on the link under `LOCATION` and you will see the in-browser terminal
session that we can use (if preferred, or mandated due to connectivity issues):

image::run-oc-terminal.png[image]


=== Setup OC CLI in web terminal

- Execute the following in the terminal:

....
$ wget {{LINUX_CLI_URL}}
$ tar zvxf {{CLI_FILENAME}}
$ mv oc /opt/app-root/bin/
$ oc version
....

NOTE: If normal cut/paste does not work, you can try to use browser's edit menu for cut/paste.

image::ocp4-web-terminal.png[image]

=== To login to a remote server

[source,shell]
----
$ oc login {{API_URL}}
----

NOTE: Username and password will be provided by your instructor.


Congratulations!! You now know how to create a project, an application
using an external docker image and navigate around. You also install OC CLI on
the web terminal to access the cluster via CLI.
